<template name="sprint">
  {{#with sprint}}
    <div class="pull-left" style="width: 200px;">
      <a class="btn" style="margin-left: 20px;" href="/">&lt; All Sprints</a>
    </div>
    <div class="pull-right" style="width: 200px; height: 1px;"></div>
    <div style="text-align: center; margin: 0 auto;">
      <h1>{{name}}</h1>
    </div>
    <table class="sprint-table table table-bordered">
      <thead>
        <th style="text-align: center;" width="14.5%">Story</th>
        <th style="text-align: center;" width="28.5%">Not Started</th>
        <th style="text-align: center;" width="28.5%">In Progress</th>
        <th style="text-align: center;" width="28.5%">Done</th>
      </thead>
      <tbody>
        {{#each stories}}
          {{> story}}
        {{/each}}
        <tr class="add-story-row" >
          <td colspan="4" style="text-align: center;">
            <button type="button" class="btn show-add-story-dialog" data-toggle="modal" data-target="#add-story-dialog" style="visibility: hidden;">Add Story</button>
          </td>
        </tr>
      </tbody>
    </table>
  {{/with}}
  {{> newStoryDialog}}
  {{> newTaskDialog}}
  {{> storyDetailsDialog}}
</template>

<template name="story">
  {{#with story}}
  <tr class="story-row" data-id="{{_id}}">
    <td class="story-cell">
      <div style="text-align: center; margin: 0 auto;">
        <span class="story-name">{{name}}</span>
        <div class="story-controls" style="visibility: hidden;">
          <a class="show-story-details-dialog btn btn-link">Details</a>
          <a class="show-add-task-dialog btn btn-link" data-toggle="modal" data-target="#add-task-dialog">+Task</a>
        </div>
      </div>
    </td>
    <td class="droppable" data-status="notstarted">
      <div class="tasks-container">
        {{#each tasks}}
          {{#if taskStatus "notstarted"}}
            {{> task}}
          {{/if}}
        {{/each}}
      </div>
    </td>
    <td class="droppable" data-status="inprogress">
      <div class="tasks-container">
        {{#each tasks}}
          {{#if taskStatus "inprogress"}}
            {{> task}}
          {{/if}}
        {{/each}}
      </div>
    </td>
    <td class="droppable" data-status="done">
      <div class="tasks-container">
        {{#each tasks}}
          {{#if taskStatus "done"}}
            {{> task}}
          {{/if}}
        {{/each}}
      </div>
    </td>
  </tr>
  {{/with}}
</template>

<template name="task">
  <div class="task" style="background-color: {{color}}" data-id="{{id}}">
    <div>
      <small class="pull-left">{{name}}</small>
      <i class="edit-task icon-edit pull-right" style="visibility: hidden;"></i>
      <div class="clearfix"></div>
    </div>
    <div style="text-align: center;"><h5>{{description}}</h5></div>
    <div style="text-align: right;"><small>{{owner}}: {{hours}} hrs</small></div>
  </div>
</template>